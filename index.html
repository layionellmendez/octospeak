<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>OctoSpeak</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .title {
      font-size: 28px;
      margin-bottom: 20px;
    }

    .textarea-container {
      width: 100%;
      max-width: 500px;
      margin-bottom: 20px;
    }

    textarea {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
    }

    .voice-select {
      width: 100%;
      max-width: 300px;
      margin-bottom: 20px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
    }

    .audio-player {
      margin-top: 20px;
      display: none;
    }

    .audio-player audio {
      width: 100%;
    }

    .download-button {
      display: none;
      margin-top: 20px;
      font-size: 16px;
    }

    @media (max-width: 500px) {
      .container {
        margin-top: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="title">OctoSpeak</h1>
    <div class="textarea-container">
      <textarea id="text" placeholder="Escribe el texto aquí" rows="4" cols="50"></textarea>
    </div>
    <select id="voiceSelect" class="voice-select"></select>
    <button id="speakBtn">Leer en voz alta</button>
    <div class="audio-player" id="audioPlayer">
      <audio id="audioElement" controls></audio>
    </div>
    <button id="downloadBtn" class="download-button" style="display: none;">Descargar audio</button>
  </div>

  <script>
utterance.onend = function() {
  var audioBuffer = utterance.audioBuffer;
  var audioContext = new AudioContext();
  var audioSource = audioContext.createBufferSource();
  audioSource.buffer = audioBuffer;

  var destinationNode = audioContext.createMediaStreamDestination();
  audioSource.connect(destinationNode);
  audioSource.start();

  var mediaRecorder = new MediaRecorder(destinationNode.stream);
  var audioChunks = [];

  mediaRecorder.ondataavailable = function(e) {
    audioChunks.push(e.data);
  };

  mediaRecorder.onstop = function() {
    var audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
    var audioUrl = URL.createObjectURL(audioBlob);

    downloadBtn.style.display = 'inline'; // Mostrar el botón de descarga después de que se complete la síntesis de voz
    audioPlayer.style.display = 'block'; // Mostrar el reproductor de audio después de que se complete la síntesis de voz

    audioElement.src = audioUrl;
    downloadBtn.onclick = function() {
      var a = document.createElement('a');
      a.href = audioUrl;
      a.download = 'texto_a_voz.wav';
      a.click();
    };
  };

  mediaRecorder.start();
  setTimeout(function() {
    mediaRecorder.stop();
  }, 2000); // Establecer una duración para la grabación, en este caso, 2 segundos
};

  </script>
</body>
</html>
